<!doctype html>
<html lang="en">
  <head>
    <title>HTMLPLUS | UI EXAMPLES</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        margin: 0;
      }
      #container {
        display: flex;
      }
      #menu {
        width: 280px;
        overflow-y: auto;
        height: 100vh;
        display: flex;
        flex-direction: column;
      }
      #content {
        flex-grow: 1;
        height: 100vh;
      }
      iframe {
        border: none;
        display: block;
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body onload="load()">
    <div id="container">
      <div id="menu"></div>
      <div id="content"></div>
    </div>
    <script>
      const API_LIST = '/api/examples';
      const API_DETAILS = '/api/examples/';
      const MAPPER = [
        ['https://cdn.skypack.dev/@htmlplus/ui/config.js', '/src/config/index.ts'],
        ['https://cdn.skypack.dev/@htmlplus/ui/animation/names/(.*?).js', '/src/elements/animation/assets/names/$1.js'],
        ['https://cdn.skypack.dev/@htmlplus/ui/(.*?).js', '/src/elements/$1/$1.tsx'],
        ['https://cdn.skypack.dev/', '/node_modules/'],
      ]
      async function load() {
        const response = await fetch(API_LIST);
        const keys = await response.json();
        for (const key of keys) {
          const button = document.createElement('button');
          button.textContent = key.split('/')[2] + ' > ' + key.split('/')[4];
          menu.append(button);
          button.addEventListener('click', async () => {
            const iframe = document.createElement('iframe');
            const response = await fetch(API_DETAILS + key);
            let text = await response.text();
            MAPPER.forEach(([a, b]) => {
              text = text.replace(new RegExp(a, 'g'), b);
            })
            iframe.srcdoc = text;
            content.innerHTML = '';
            content.appendChild(iframe);
          })
        }
      }
    </script>
  </body>
</html>
